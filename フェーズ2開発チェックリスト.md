# フェーズ2開発チェックリスト

## 🔧 Phase 1: 基盤整備（5時間）✅ 完了

### 環境準備
- [x] 環境変数の追加（MEDICAL_PASS, DENTAL_PASS, OTHERS_PASS）
- [x] Google Maps API キーの取得と設定
- [x] 開発用ブランチの作成

### プロジェクト構造調整
- [x] 診療科別のディレクトリ構造作成
  - [x] `/frontend/medical/`
  - [x] `/frontend/dental/`
  - [x] `/frontend/others/`
- [x] 共通コンポーネントディレクトリの作成
  - [x] `/frontend/shared/`

### Basic認証の拡張
- [x] `auth.py`に診療科別認証関数を追加
- [x] 環境変数からのパスワード読み込み実装

## 🏥 Phase 2: 診療科別アクセス制御（3時間）✅ 完了

### ルーティング設定
- [x] `main.py`に診療科別エンドポイント追加
  - [x] `/medical` エンドポイント
  - [x] `/dental` エンドポイント
  - [x] `/others` エンドポイント
- [x] 各エンドポイントにBasic認証適用
- [x] 診療科別のindex.htmlファイル作成

### UI実装
- [x] 診療科選択画面の作成
- [x] 各診療科用のカスタマイズ（ロゴ、カラーテーマ）
- [x] レスポンシブ対応の確認

### 追加実装
- [x] 診療科カテゴリー別APIの実装
- [x] 動的な診療科読み込み機能（department-loader.js）
- [x] イベントリスナーの修正（ボタン選択問題の解決）

## 📋 Phase 3: 主訴別ペルソナ生成（10時間）✅ 完了

### データ構造の準備 ✅ 完了
- [x] `config/chief_complaints.json`の作成
  - [x] 医科の主訴データ（19診療科）
    - 眼科: 15項目
    - 内科: 26項目
    - 外科: 20項目
    - 小児科: 35項目
    - 整形外科: 21項目
    - 耳鼻咽喉科: 16項目
    - 皮膚科: 19項目
    - 婦人科: 18項目
    - 泌尿器科: 20項目
    - 精神科: 21項目
    - 脳神経外科: 20項目
    - 循環器内科: 16項目
    - 消化器内科: 19項目
    - 呼吸器内科: 14項目
    - 糖尿病内科: 10項目
    - 腎臓内科: 13項目
    - 神経内科: 15項目
    - 血液内科: 12項目
    - 内分泌科: 11項目
  - [x] 歯科の主訴データ（5診療科）
    - 歯科: 19項目
    - 小児歯科: 16項目
    - 審美歯科: 11項目
    - 矯正歯科: 16項目
    - 口腔外科: 22項目
  - [x] その他の主訴データ（6診療科）
    - 麻酔科: 10項目
    - 放射線科: 11項目
    - リハビリテーション科: 15項目
    - アレルギー科: 13項目
    - 形成外科: 16項目
    - 美容外科: 16項目
- [x] 主訴別のペルソナテンプレート作成（プロンプトに組み込み）
- [x] RAGデータのCSVファイル準備（各診療科別主訴.csv使用）

### API実装 ✅ 完了
- [x] 主訴リスト取得エンドポイント
  - `GET /api/chief-complaints/{category}/{department}`
  - カテゴリと診療科名から主訴リストを返す
- [x] 主訴別ペルソナ生成エンドポイント
  - `POST /api/generate-by-complaint`
  - 主訴を含めたペルソナ生成
- [x] 既存のペルソナ生成ロジックとの統合

### UI実装（3ステップフロー）✅ 完了
- [x] ステップ1: 診療科選択画面
- [x] ステップ2: 主訴選択画面
- [x] ステップ3: 作成目的選択画面
- [x] プログレスバーの実装（5ステップに変更）
- [x] 戻るボタンの実装
- [x] 医科（medical）の実装完了
- [x] 歯科（dental）の実装完了
- [x] その他（others）の実装完了

### RAGデータのコードベース管理への移行 🚧 未実装
- [ ] CSVファイルからJSON形式への変換
  - [ ] 各診療科の全体データ（30診療科）
    - 接触皮膚炎までCSV用意。https://docs.google.com/spreadsheets/d/1MfrMl6e-Lhc_XJjFynaXLnIlBv486bmAHLiBwbqvWJs/edit?gid=79355194#gid=79355194
  - [ ] 主訴別データ（眼科のみ実装済み）
- [ ] `config/rag_data.json`ファイルの作成
- [ ] 既存のSQLite/永久ディスク依存の削除
  - [ ] `rag_processor.py`の修正（JSON読み込みに変更）
  - [ ] 管理画面のアップロード機能の削除
- [ ] アプリ起動時のRAGデータ読み込み処理の実装

## 📊 Phase 4: 検索キーワード時系列分析（12時間）

### Chart.js統合
- [ ] Chart.jsのCDN追加
- [ ] 散布図コンポーネントの作成
- [ ] レスポンシブチャート設定

### データ処理
- [ ] サンプルデータJSONの作成
- [ ] 時系列データ処理エンドポイント
- [ ] データフォーマット変換関数

### AI分析機能
- [ ] 時系列分析用プロンプトテンプレート作成
- [ ] AIレポート生成エンドポイント
- [ ] レポート表示コンポーネント

### UI実装
- [ ] 時系列分析ページの作成
- [ ] データアップロード機能（CSV）
- [ ] 期間選択フィルター
- [ ] エクスポート機能（PDF/画像）

## 🎯 Phase 5: 競合分析（3C/SWOT分析）（10時間）

### Google Maps API統合
- [ ] Places APIの有効化
- [ ] 競合検索関数の実装
- [ ] 検索半径の設定機能

### 分析ロジック
- [ ] 自院情報入力フォーム
- [ ] 競合自動検出アルゴリズム
- [ ] 競合情報の取得と整形

### SWOT分析生成
- [ ] SWOT分析テンプレートの作成
- [ ] AI分析プロンプトの作成
- [ ] 分析結果の構造化

### UI実装
- [ ] 競合分析ページの作成
- [ ] 自院情報入力フォーム
- [ ] 競合リスト表示
- [ ] SWOT分析結果表示
- [ ] レポートエクスポート機能

## 🧪 Phase 6: テストと調整（3時間）

### 統合テスト
- [ ] 診療科別アクセスのテスト
- [ ] 主訴別ペルソナ生成のテスト
- [ ] 時系列分析のテスト
- [ ] 競合分析のテスト

### パフォーマンス最適化
- [ ] API レスポンスの最適化
- [ ] フロントエンドの読み込み速度改善
- [ ] エラーハンドリングの実装

### ドキュメント作成
- [ ] 使用方法ガイドの作成
- [ ] 管理者向け設定ガイド
- [ ] デプロイ手順の更新

## 📦 Phase 7: デプロイ準備（2時間）

### 環境設定
- [ ] Render.comの環境変数設定
- [ ] 本番用APIキーの設定
- [ ] セキュリティ設定の確認

### 最終確認
- [ ] 全機能の動作確認
- [ ] レスポンシブデザインの確認
- [ ] クロスブラウザテスト

### リリース
- [ ] 本番環境へのデプロイ
- [ ] 動作確認
- [ ] クライアントへの納品準備

---

**総工数**: 55時間
**優先度**: 
- 🔴 高：Phase 1-3（基盤〜主訴別ペルソナ）
- 🟡 中：Phase 4-5（時系列分析〜競合分析）
- 🟢 低：Phase 6-7（テスト〜デプロイ）

**段階的実装の場合**:
- 第1段階：Phase 1-3（約20万円）
- 第2段階：Phase 4-5（約15万円）